function resizeTextArea(C,A,E){var B=getViewportHeight();var D=getViewportWidth();if(C!=null){C.style.width=(D-A)+"px";C.style.height=(B-getY(C)-E)+"px"}}var ctrlDown=false;var shiftDown=false;var keycode=0;function shortcutCheckKeysDown(A){ctrlDown=A.ctrlKey;shiftDown=A.shiftKey;keycode=A.keyCode;if(ctrlDown&&keycode==83){doSubmit();if(window.addEventListener){A.preventDefault()}else{return false}}if(ctrlDown&&keycode==71){umbracoInsertField("","xsltInsertValueOf","","felt",750,230,"");if(window.addEventListener){A.preventDefault()}else{return false}}}function shortcutCheckKeysUp(A){ctrlDown=A.ctrlKey;shiftDown=A.shiftKey}function shortcutCheckKeysPressFirefox(A){if(ctrlDown&&keycode==83){A.preventDefault()}}if(window.addEventListener){document.addEventListener("keyup",shortcutCheckKeysUp,false);document.addEventListener("keydown",shortcutCheckKeysDown,false);document.addEventListener("keypress",shortcutCheckKeysPressFirefox,false)}else{document.attachEvent("onkeyup",shortcutCheckKeysUp);document.attachEvent("onkeydown",shortcutCheckKeysDown)}var tab={key:9,string:"\t",nl2br:true,tosp:true,watching:{},results:{},$:function(A){return document.getElementById(A)},watch:function(A){if(A&&this.$(A)){this.watching["_"+A]=this.$(A);this.addEvent(this.$(A),"keydown",function(J){var G=tab.$(A).scrollTop;var D=tab.$(A).value.length;var J=(J)?J:((window.event)?event:null);if(J){var C=(J.target)?J.target:((J.srcElement)?J.srcElement:null);if(C){var H=(J.charCode)?J.charCode:((J.which)?J.which:J.keyCode);if(H==tab.key){if(tab.$(A).attachEvent){var F=document.selection.createRange();F.text=tab.string;F.moveStart("character",-1)}else{if(typeof tab.$(A).selectionStart!="undefined"){var B=tab.$(A).value.substr(0,tab.$(A).selectionStart);var E=tab.$(A).value.substr(tab.$(A).selectionStart,D);var I=tab.$(A).value.replace(B,"").replace(E,"");tab.$(A).value=B+tab.string+I+E;tab.$(A).setSelectionRange(B.length+1,B.length+1);tab.$(A).scrollTop=G}else{tab.$(A).value+=tab.string}}if(J.preventDefault){J.preventDefault();J.stopPropagation()}else{J.returnValue=false;J.cancelBubble=true}return false}}}})}},click:function(B,A){if(B&&this.$(B)){this.addEvent(this.$(B),"click",function(){tab.results["_"+this.id.split("_")[1]]=tab.parse(tab.watching["_"+this.id.split("_")[1]].value);if(A&&A.constructor==Function){A()}})}},get:function(A){if(A&&this.$(A)){return this.results["_"+A]}},parse:function(A){var A=(A)?A:"";if(A.length){if(this.tosp){A=A.replace(/\t/g,"&nbsp;&nbsp;&nbsp;")}if(this.nl2br){A=A.replace(/\r?\n/g,"<br />")}}return A},addEvent:function(C,B,A){if(C.attachEvent){C["e"+B+A]=A;C[B+A]=function(){C["e"+B+A](window.event)};C.attachEvent("on"+B,C[B+A])}else{C.addEventListener(B,A,false)}}};function insertCode(G,E,A){var F=document.getElementById(A);var I=F.scrollTop;var G=(G)?G:"";var E=(E)?E:"";var D;var C=navigator.userAgent.match("MSIE");if(C!=null){C=true}else{C=false}if(C){F.focus();var H=F.currRange;if(arguments[3]){if(E==""){H.text=G+arguments[3]}else{H.text=G+arguments[3]+H.text+E}}else{if(E==""){H.text=G}else{H.text=G+H.text+E}}H.select()}else{if(!C&&typeof F.selectionStart!="undefined"){var B=F.value.substr(0,F.selectionStart);var K=F.value.substr(F.selectionEnd,F.value.length);var J=F.value.replace(B,"").replace(K,"");if(arguments[3]){if(E==""){D=B+G+arguments[3];F.value=D+K}else{D=B+G+arguments[3]+J+E;F.value=D+K}}else{if(E==""){D=B+G;F.value=D+K}else{D=B+G+J+E;F.value=D+K}}F.setSelectionRange(D.length,D.length);F.focus();F.scrollTop=I}else{F.value+=(arguments[3])?G+arguments[3]+E:G+E}}}var tempCaretEl;function storeCaret(A){if(A.createTextRange){A.currRange=document.selection.createRange().duplicate()}}function setCaretToEnd(B){if(B.createTextRange){var A=B.value;var C=B.createTextRange();C.moveStart("character",A.length);C.select()}}function insertAtEnd(B,A){A=caretTextUnencode(A);B.value+=A;setCaretToEnd(B)}function insertAtCaret(B,A){A=caretTextUnencode(A);if(B.currRange){B.currRange.text=B.currRange.text.charAt(B.currRange.text.length-1)!=" "?A:A+" ";B.currRange.select()}else{insertAtEnd(B,A)}}function insertAtCaretAndMove(C,A,B){A=caretTextUnencode(A);if(C.currRange){C.currRange.text=C.currRange.text.charAt(C.currRange.text.length-1)!=" "?A:A+" ";C.currRange.moveStart("character",B);C.currRange.moveEnd("character",B);C.currRange.select()}else{insertAtEnd(C,A)}}function caretTextUnencode(A){return A};
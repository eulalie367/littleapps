var mustache = require("mustache"),
	handlebars = require("handlebars"),
   url = require("url"),
	libpath = require("path"),
   fs = require("fs");

exports.templateExtension = ".mus";

var path = "./Views/";

exports.render = function(fileName, model, callback)
{	
	fileName = libpath.resolve(path + fileName + exports.templateExtension);

	libpath.exists(fileName, function (exists)
	{
		if(exists)
		{
			fs.readFile(fileName, "binary", function (err, file)
			{
				if(err == null)
				{
					switch(exports.templateExtension)
					{
						case ".mus"://mustache
							callback(mustache.to_html(file, model), false);
						break;
						case ".hbs"://handlebars
							var template = handlebars.compile(file);
							callback(template(model), false);
						break;
					}
				}
				else
				{
					callback(err, true);
				}
			});
		}
		else
		{
			callback("", true);
		}
	});
}

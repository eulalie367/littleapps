var requireindex = require('requireindex'),
	 controllers = requireindex("./Controllers");


exports.server = require("./server.js");
exports.view = require("./view.js");

exports.SiteMap = function(){ return fetchMenu(controllers, { path: "" }); }
function fetchMenu(object, map)
{
	var hasChildren = false;
	for(var p in object)
	{
		hasChildren = true;
		var path = map.path + "/" + p;
		map.path = path;//set path before we get the children
		var children = fetchMenu(object[p], map);
		if(children != null)
		{
			map = 
			{
				name: p,
				path: path,
				children: children
			};
		}
		else
		{
			map = 
			{
				name: p,
				path: path
			};
		}
	}
	return hasChildren ? map : null;
}


